implementationroute{foreveryiteminchildrenofme=>child{foreveryiteminoutputQueueofchild.runnable=>output_message{synonymmessage=output_message{findconnectioninmegivenchildXmessage.etag=>connection{lockreceiversofconnection{foreveryreceiversinconnection=>dest{synonymparams={me,dest,message}{cond{dest.nameisnotme{@deliver_to_child_input<=params}}{dest.nameisme{@deliver_to_me_output<=params}}}}}}}}{@child.runnable.resetOutputQueue}}}syncdeliver_to_child_input<=me,dest,message{varinput_message$i{<={dest.etag,message.data}message}{lookupdest.name=>receiver{@receiver.enqueueInput<=input_message}}}syncdeliver_to_me_output<=me,dest,message{varoutput_message$o{<={receiver.etag,message.data}message}{@me.enqueueOutput<=output_message}}
